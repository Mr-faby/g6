<template>
  <div style="height: 100%">
    <preview v-if="isPreview"></preview>
    <topology-design
      v-else
      :components="components"
      :graphData="graphData"
      @saveGraph="saveGraph"
    ></topology-design>
  </div>
</template>

<script setup lang="ts">
import { ref, onBeforeMount } from 'vue'
import { useRoute } from 'vue-router'
import TopologyDesign from './index.vue'
import preview from './preview.vue'
import type { DesignComponent } from './type'

type GraphDTO = {
  canvasId: string
  canvasData: string
  canvasName: string
  remark: string
}

const route = useRoute()

const isPreview = ref(false)
// å…ƒç´ åˆ—è¡¨
const components: DesignComponent[] = [
  {
    controlName: 'æ•°æ®ä¸­å¿ƒ',
    controlIcon: 'smile',
    controlId: 'dataCenter',
    controlShape: 'rect',
    layerType: 'middleWareLayer',
    attrData: [
      {
        attributeInstanceId: 'attributexk3mcnnn66n9b6c124bn26r',
        dataName: 'Input',
        attributeId: '04f9e4bf469c49618d11345a07944614',
        attributeInstanceValue: '',
        attributeName: 'è¾“å…¥å±æ€§',
        attributeDefaultValue: ''
      }
    ]
  },
  {
    controlName: 'ä¸­é—´ä»¶',
    controlIcon: 'middleWare',
    controlId: 'middleWare',
    controlShape: 'rect',
    layerType: 'physicalLayer',
    attrData: [
      {
        attributeInstanceId: 'attributehz7xjimvhqrbctjimgeroay',
        dataName: 'Radio',
        attributeId: 'c6898dc0401a45f9be2e84b6731adee9',
        attributeInstanceValue: 'GET|POST|[DELETE]|PUT|HEAD|TRACE|OPTIONS',
        attributeName: 'å•é€‰å±æ€§',
        attributeDefaultValue: 'GET|POST|[DELETE]|PUT|HEAD|TRACE|OPTIONS'
      }
    ]
  },
  {
    controlName: 'æ‰§è¡Œå¼•æ“',
    controlIcon: 'engine',
    controlId: 'engine',
    controlShape: 'rect',
    layerType: 'applicationLayer',
    attrData: [
      {
        attributeInstanceId: 'attributeec6v5hapcknimm10r3y3zk6',
        dataName: 'Checkbox',
        attributeId: 'beb6a039d835488da92444f4e40cfc81',
        attributeInstanceValue: '[A]|B|[C]|D',
        attributeName: 'å¤šé€‰å±æ€§',
        attributeDefaultValue: '[A]|B|[C]|D'
      }
    ]
  },
  {
    controlName: 'æ¥å£',
    controlIcon: 'interface',
    controlId: 'interface',
    controlShape: 'rect',
    layerType: 'businessLayer',
    attrData: [
      {
        attributeInstanceId: 'attributenciqpjrgf6y8i3kkfsdg8ryu4v',
        dataName: 'Select',
        attributeId: '46536d0d2dbe488e963ec30807eb5e6c',
        attributeInstanceValue: 'A|[B]|C|D',
        attributeName: 'ä¸‹æ‹‰å±æ€§',
        attributeDefaultValue: 'A|[B]|C|D'
      }
    ]
  },
  {
    controlName: 'é¡¹ç›®',
    controlIcon: 'project',
    controlId: 'project',
    controlShape: 'rect',
    layerType: 'applicationLayer',
    attrData: [
      {
        attributeInstanceId: 'attributenciqpjrgf6y8i3kk2f8ry',
        dataName: 'Number',
        attributeId: 'c97fa3ec6fc342e438b3c88a5624a3e29',
        attributeInstanceValue: '',
        attributeName: 'æ•°å­—è¾“å…¥å±æ€§',
        attributeDefaultValue: ''
      }
    ]
  },
  {
    controlName: 'ç³»ç»Ÿ',
    controlIcon: 'system',
    controlId: 'system',
    controlShape: 'rect',
    layerType: 'businessLayer',
    attrData: [
      {
        attributeInstanceId: 'attributehz7xjimvhghherssfaase',
        dataName: 'Color',
        attributeId: 'c6898dc0401a45f9be2e3e4d4f5g',
        attributeInstanceValue: 'green',
        attributeName: 'é¢œè‰²å±æ€§',
        attributeDefaultValue: 'green'
      }
    ]
  },

  {
    controlName: 'æœåŠ¡å™¨',
    controlIcon: 'server',
    controlId: 'server',
    controlShape: 'rect',
    layerType: 'middleWareLayer',
    attrData: [
      {
        attributeInstanceId: 'attributehz7xjimvhqrbctjimgeroay',
        dataName: 'Textarea',
        attributeId: 'c6898dc0401a45f9be23d3e3ss6g',
        attributeInstanceValue: '',
        attributeName: 'å¤šè¡Œè¾“å…¥å±æ€§',
        attributeDefaultValue: ''
      }
    ]
  },
  {
    controlName: 'æ•°æ®åº“',
    controlIcon: 'data',
    controlId: 'data',
    controlShape: 'rect',
    layerType: 'physicalLayer',
    attrData: [
      {
        attributeInstanceId: 'attributehz7xjiheewsddx',
        dataName: 'Input',
        attributeId: 'c6898dc0401a45f9be2ett8e9e55f',
        attributeInstanceValue: '',
        attributeName: 'è¾“å…¥å±æ€§',
        attributeDefaultValue: ''
      }
    ]
  }
]
// å›¾è¡¨æ•°æ®
const graphData: Record<string, any> = {
  nodes: [],
  edges: []
}

onBeforeMount(() => {
  isPreview.value = !!route.query.isPreview
})

function saveGraph() {
  console.log(
    '%c ğŸ² graphData: ',
    'font-size:12px;background-color: #EA7E5C;color:#fff;',
    graphData
  )
}
</script>
