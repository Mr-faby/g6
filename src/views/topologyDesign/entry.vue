<template>
  <div style="height: 100%">
    <preview v-if="isPreview"></preview>
    <topology-design
      v-else
      :components="components"
      :graphData="graphData"
      @saveGraph="saveGraph"
    ></topology-design>
  </div>
</template>

<script setup lang="ts">
import { ref, onBeforeMount } from 'vue'
import { useRoute } from 'vue-router'
import TopologyDesign from './index.vue'
import preview from './preview.vue'
import type { DesignComponent } from './type'

type GraphDTO = {
  canvasId: string
  canvasData: string
  canvasName: string
  remark: string
}

const route = useRoute()

const isPreview = ref(false)
// å…ƒç´ åˆ—è¡¨
const components: DesignComponent[] = [
  {
    controlName: 'æ•°æ®ä¸­å¿ƒ',
    controlIcon: 'smile',
    controlId: 'dataCenter',
    controlShape: 'rect',
    layerType: 'middleWareLayer',
    attrData: [
      {
        dataName: 'input',
        attributeId: 'c1',
        attributeInstanceId: 'c1',
        attributeName: 'å®ä¾‹åç§°',
        attributeInstanceValue: '',
        attributeDefaultValue: ''
      },
      {
        attributeInstanceId: 'attributehz7xjimvhqrbctjimgeroay',
        dataName: 'radio',
        attributeId: 'c6898dc0401a45f9be2e84b6731adee9',
        attributeInstanceValue: 'GET|POST|DELETE|PUT|HEAD|TRACE|OPTIONS',
        attributeName: 'è¯·æ±‚æ–¹æ³•',
        attributeDefaultValue: 'GET|POST|DELETE|PUT|HEAD|TRACE|OPTIONS'
      }
    ]
  },
  {
    controlName: 'ä¸­é—´ä»¶',
    controlIcon: 'middleWare',
    controlId: 'middleWare',
    controlShape: 'rect',
    layerType: 'physicalLayer',
    attrData: []
  },
  {
    controlName: 'æ‰§è¡Œå¼•æ“',
    controlIcon: 'engine',
    controlId: 'engine',
    controlShape: 'rect',
    layerType: 'applicationLayer',
    attrData: []
  },
  {
    controlName: 'æ¥å£',
    controlIcon: 'interface',
    controlId: 'interface',
    controlShape: 'rect',
    layerType: 'businessLayer',
    attrData: []
  },
  {
    controlName: 'é¡¹ç›®',
    controlIcon: 'project',
    controlId: 'project',
    controlShape: 'rect',
    layerType: 'applicationLayer',
    attrData: []
  },
  {
    controlName: 'ç³»ç»Ÿ',
    controlIcon: 'system',
    controlId: 'system',
    controlShape: 'rect',
    layerType: 'businessLayer',
    attrData: []
  },

  {
    controlName: 'æœåŠ¡å™¨',
    controlIcon: 'server',
    controlId: 'server',
    controlShape: 'rect',
    layerType: 'middleWareLayer',
    attrData: []
  },
  {
    controlName: 'æ•°æ®åº“',
    controlIcon: 'data',
    controlId: 'data',
    controlShape: 'rect',
    layerType: 'physicalLayer',
    attrData: []
  }
]
// å›¾è¡¨æ•°æ®
const graphData: Record<string, any> = {
  nodes: [],
  edges: []
}

onBeforeMount(() => {
  isPreview.value = !!route.query.isPreview
})

function saveGraph() {
  console.log(
    '%c ğŸ² graphData: ',
    'font-size:12px;background-color: #EA7E5C;color:#fff;',
    graphData
  )
}
</script>
